<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1,minimal-ui" name="viewport">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
    <link rel="stylesheet" href="assets/vue-material.min.css">
    <link rel="stylesheet" href="assets/default.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.13/vue.js"></script>
    <script src="assets/vue-material.min.js"></script>

    <style>
      [v-cloak] {
        display: none;
      }

      body {
        padding: 20px;
      }

      #app {
        max-width: 1240px;
        margin: auto;
      }

      .fa {
        display: inline; /* this is terrible */
      }

      .md-layout {
        min-height: 37px;
        line-height: 14px;
        display: flex;
      }

      .cell + .cell {
        padding-left: 2px;
      }

      .cell {
        display: inline-block;
        border-radius: 2px;
        border: 1px solid blue;
        background-color: #607D8B;
        user-select: none;
        transition: 0.1s all;

        flex-grow: 1;

        position: relative;
        text-align: center;
      }
        .cell--not-revealed:hover {
          box-shadow: 0 0 2px black;
          opacity: 0.8;
        }
        .cell--revealed {
          background-color: #E0E0E0;
        }
        .cell--mine {
          background-color: #b71c1c;
          color: white;
        }
        .cell--flagged-as-mine {
          background-color: #4CAF50;
        }
        .cell--flagged-as-possible-mine {
          background-color: #FFEB3B;
        }
        .cell--incorrect {
          background-color: #FFC107 !important;
        }
    </style>
  </head>
  <body>
    <script type="text/template" id="cellTemplate">
      <button
        class="cell"
        :class="{
          'cell--revealed': cell.revealed,
          'cell--not-revealed': !cell.revealed,
          'cell--mine': cell.revealed && cell.isMine,
          'cell--flagged-as-mine': !cell.revealed && cell.flaggedAsMine,
          'cell--flagged-as-possible-mine': !cell.revealed && cell.flaggedAsPossibleMine,
          'cell--incorrect': cell.incorrect,

          'animated tada': cell.revealed && cell.isMine,
        }"
        :md-ripple="false"
        v-on:click="reveal"
        v-on:click.right.prevent="onRightClick"
      >
        <template v-if="!cell.revealed && cell.flaggedAsMine">
          <i class="fa fa-flag"></i>
        </template>
        <template v-if="!cell.revealed && cell.flaggedAsPossibleMine">
          <i class="fa fa-question-circle"></i>
        </template>
        <template v-if="cell.revealed && cell.isMine">
          <i class="fa fa-bomb"></i>
        </template>
        <template v-if="cell.revealed && !cell.isMine && cell.surroundingMines.length > 0">
          {{ cell.surroundingMines.length }}
        </template>
      </button>
    </script>

    <div id="app" v-cloak>
      <md-card style="width: 100%;">
        <md-card-header>
          <div class="md-title">Minesweeper {{ gameStatus }}</div>
          <div>Mines: {{ mineCount }}</div>
        </md-card-header>

        <md-card-content>
          <div class="md-layout" v-for="row in rows">
            <cell v-for="column in columns" :cell="cells[((row -1) * (column -1)) + column - 1]"></cell>
          </div>
        </md-card-content>

        <md-card-actions>
          <md-button v-on:click="solve">Solve</md-button>
          <md-button v-on:click="solveWithPossibleFlags">Solve w/ possible flags</md-button>
          <md-button v-on:click="solveOneStep">Solve 1 Step</md-button>
          <md-button v-on:click="reload">New Game</md-button>
        </md-card-actions>
      </md-card>
    </div>

    <script src="index.js"></script>
  </body>
</html>
